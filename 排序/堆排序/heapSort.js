// å †æ’åº
// å †æ˜¯ç‰¹æ®Šçš„å®Œå…¨äºŒå‰æ ‘  é€šå¸¸åˆ†ä¸ºæœ€å°å †å’Œæœ€å¤§å †
// å †æ’åºæ˜¯åˆ©ç”¨å †è¿™ç§æ•°æ®ç»“æ„è€Œè®¾è®¡çš„ä¸€ç§æ’åºç®—æ³•
// jså¼•ç”¨ç±»å‹å­˜æ”¾åœ¨å †ï¼Ÿ ä¸ºä»€ä¹ˆ æ„Ÿè§‰æ€ªæ€ªçš„ 

const heapSort = function (arr) {
    // å°†é¡ºåºå‚¨å­˜äºŒå‰æ„å»ºæˆæœ€å¤§å †
    // è¯¥æ–¹æ³•ç”¨äºè‡ªä¸Šè€Œä¸‹çš„å»ºç«‹å¤§é¡¶å † 
    const adjustHeap = function (arr, i, length) {
        let temp = arr[i] // ä¿å­˜ièŠ‚ç‚¹çš„å€¼
        // k=i*2+1 
        // ièŠ‚ç‚¹è¡¨ç¤ºéå¶å­ğŸƒèŠ‚ç‚¹
        // kè¡¨ç¤ºièŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹,k+1è¡¨ç¤ºå³å­èŠ‚ç‚¹
        for (k = i * 2 + 1; k < length; k = k * 2 + 1) {
            if (k + 1 < length && arr[k] < arr[k + 1]) {
                k++ // æŒ‡å‘å³å­èŠ‚ç‚¹
            }
            if (arr[k] > temp) {
                // å­èŠ‚ç‚¹å¤§äºçˆ¶èŠ‚ç‚¹
                arr[i] = arr[k]
                // å› ä¸ºå½“å‰çš„iéå¶å­èŠ‚ç‚¹ä»¥åŠå®Œæˆäº¤æ¢
                // æ‰€ä»¥æˆ‘ä»¬æŒ‡å‘ä¸‹ä¸€ä¸ªéå¶å­èŠ‚ç‚¹ï¼ˆä¹Ÿå¯èƒ½æ˜¯å¶å­èŠ‚ç‚¹ï¼‰
                // åªè€ƒè™‘å•å‘çš„æƒ…å†µå— å› ä¸ºè‡ªä¸Šè€Œä¸‹çš„æ„å»ºæ—©å°±ç¡®å®šå¥½é¡ºåºçš„äº† åªæœ‰ä½ éå¶å­èŠ‚ç‚¹æ”¹å˜äº† å°±åœ¨å¯¹åº”çš„èŠ‚ç‚¹é‡æ–°æ„å»º å“ªä¸ªèŠ‚ç‚¹æ”¹å˜äº† å°±åŠ¨è¿™ä¸ªèŠ‚ç‚¹
                i = k // æŒ‡å‘kï¼Œç»§ç»­å¾ªç¯æ¯”è¾ƒ
            } else {
                // è¯´æ˜åˆšå¥½è¿™ä¸€å±‚æ˜¯ä¸ªå±€éƒ¨å¤§é¡¶å †è€Œä¸”å› ä¸ºå› ä¸ºä»ä¸‹åˆ°ä¸Šçš„ ä¸è¿›è¡Œæ“ä½œ
                // å› ä¸ºä»ä¸‹åˆ°ä¸Šçš„ æ‰€ä»¥æ²¡æœ‰å¿…è¦ç»§ç»­å¾ªç¯ä¸‹å»
                break
            }
        }
        arr[i] = temp
    }
    let temp = 0
    // å°†æ— åºåºåˆ—æ„å»ºæˆä¸€ä¸ªå †ï¼Œæ ¹æ®å‡åºé™åºéœ€æ±‚é€‰æ‹©å¤§é¡¶å †æˆ–è€…å°é¡¶å †
    // Math.floor(arr.length / 2) - 1 è¿™ä¸€å—ä¹‹æ‰€ä»¥è¿™ä¹ˆå†™ç²¾ç¡® æ˜¯è‡ªä¸‹è€Œä¸Šä¸€ä¸ªä¸€ä¸ªæ‰¾ 
    for (let i = Math.floor(arr.length / 2) - 1; i >= 0; i--) {
        // ä»ä¸Šåˆ°ä¸‹å·²ç»å¯ä»¥ç¡®å®šæ¯ä¸€å±‚çš„é¡ºåº
        // æ‰€ä»¥æ­¤æ—¶å·¦å³å­èŠ‚ç‚¹æ˜¯ç¡®å®šå¥½äº†çš„
        // è¿›è¡Œæ„å»ºå¤§é¡¶å †äº¤æ¢å åªè¦å¾ªç¯äº¤æ¢æ”¹å˜çš„å­èŠ‚ç‚¹å°±è¡Œ (å¦å¤–çš„ä¸€è¾¹å·²ç»ç¡®å®š è€Œä¸”æ²¡æœ‰æ”¹å˜ å°±æ²¡æœ‰å¿…è¦è¿›è¡Œå¾ªç¯ä¸‹å»äº†)
        adjustHeap(arr, i, arr.length)
    }
    // console.log(arr)
    for (let j = arr.length - 1; j > 0; j--) {
        temp = arr[j]
        arr[j] = arr[0]
        arr[0] = temp
        // äº¤æ¢ä»¥åå‡å°‘ä¸€ä¸ªèŠ‚ç‚¹ç»§ç»­æ„å»ºå¤§é¡¶å †
        adjustHeap(arr, 0, j)
    }
}


const arr = [1110, 12, 10, 8, 4, 12, 110, 45, 78]

heapSort(arr)


console.log(arr)


